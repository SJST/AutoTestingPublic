{% load static %}
<!DOCTYPE HTML>
<!-- 这个页面用来添加新的公司  -->
<html>
{% include '../../common_html/_header.html' %}
<head>
<meta charset="utf-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />

<link rel="stylesheet" type="text/css" href="{% static 'Hui-iconfont/1.0.8/iconfont.css' %}" />
<link rel="stylesheet" type="text/css" href="{% static 'h-ui/css/H-ui.min.css' %}" />
<link rel="stylesheet" type="text/css" href="{% static 'h-ui.admin/css/H-ui.admin.css' %}" />
<title>Hi，H-ui v3.1</title>
<meta name="keywords" content="关键词,5个左右,单个8汉字以内">
<meta name="description" content="网站描述，字数尽量空制在80个汉字，160个字符以内！">
</head>
<body>
<article class="page-container">
	<form action="{% url 'ask-position' %}" method="post" class="form form-horizontal" id="ask-form">
		<div class="row cl">
			<label class="form-label col-xs-3">所属公司：</label>
			<div class="formControls col-xs-4">
					<input type="text" class="input-text" placeholder="2~16个字符，字母/中文/数字/下划线" name="company_name" id="company_name" style="display:inline-block" autocomplete="off" required>		
			</div>
			<div style="display:inline-block"><button class="btn btn-primary" type="button" id="add-company" value="" style="display:inline-block">&nbsp;&nbsp;新建&nbsp;&nbsp;</button></div>
		</div>
		<div class="row cl">
				<label class="form-label col-xs-3">职能分类：</label>
				<div class="formControls col-xs-2" style="display:block" >
					<select  class="select" size="1" name="contact_name" id="contact_name" >
	  					<option value="1" selected="selected">请选择联系人 </option>
					</select>
					
				</div>
				<div style="display:inline-block"><button class="btn btn-primary" type="button" id="add-contacts" value="" style="display:inline-block">&nbsp;&nbsp;新建&nbsp;&nbsp;</button></div>
				
		</div>
			<div class="row cl">
						<label class="form-label col-xs-3"><span class="c-red">*</span>职位名称：</label>
						<div class="formControls col-xs-4 ">
							<input type="text" class="input-text" placeholder="" name="position_name" id="position_name"  required>
						</div>
					</div>
					<!--  <div class="row cl">
						<label class="form-label col-xs-3"><span class="c-red">*</span>年薪范围：</label>
							&nbsp;&nbsp;&nbsp;&nbsp;<input type="text" name="min_salary" id="min" class="input-text " style="width:180px;" required>	
							-
							<input type="text" name="max_salary" id="max" class="input-text " style="width:180px;" required>
					</div>
					<div class="row cl">
						<label class="form-label col-xs-3"><span class="c-red">*</span>工作城市：</label>
						<div class="formControls col-xs-8 ">
							<input type="text" class="input-text" placeholder="" name="work_city" id="work_city"  required>
						</div>
					</div>
		
			<div class="row cl">
				<label class="form-label col-xs-3">职能分类：</label>
				<div class="formControls col-xs-2" style="display:block" >
					<select  class="select" size="1" name="position_name" id="position_name" >
	  					<option value="1" selected="selected">请选择一级分类 </option>
					</select>
					
				</div>
			
			
				
				<div class="formControls col-xs-2"  style="display:inline-block" >
					<select  class="select" size="1" name="second_class" id="second_class" >
	  					<option value="请选择二级分类 " selected="selected">请选择二级分类 </option>
					</select>	
				</div>
			</div>
			<div class="row cl">
				<label class="form-label col-xs-3">预计佣金：</label>
					<div class="formControls col-xs-8">
							<input type="text" class="input-text" placeholder="" name="estimate_commission" id="estimate_commission"  >
					</div>
			</div>
			<div class="row cl">
				<label class="form-label col-xs-3">工作年限：</label>
				<div class="formControls col-xs-2" style="display:inline-block" >
					<select  class="select" size="1" name="Working_life">
	  					<option value="10年以上">10年以上 </option>
	  					<option value="5-10年">5-10年</option>
	  					<option value="3-5年">3-5年</option>
	  					<option value="1-3年">1-3年</option>
	  					<option value="1年以下" selected = "selected" >1年以下</option>
	  					
					</select>
				</div>
			
			
			
				<label class="form-label col-xs-3">学历要求：</label>
				<div class="formControls col-xs-2"  style="display:inline-block" >
					<select  class="select" size="1" name="Academic_requirements">
	  					<option value="博士">博士 </option>
	  					<option value="博士后">博士后</option>
	  					<option value="硕士 ">硕士 </option>
	  					<option value="本科 " selected = "selected" >本科 </option>
	  					<option value="大专">大专</option>
	  					<option value="高中">高中</option>
	  					<option value="中专">中专</option>
	  					<option value="初中">初中</option>
	  					<option value="无">无</option>
	  					<option value="MBA">MBA</option>
	  					
					</select>
					
				</div>
			</div>
			<div class="row cl">
				
				<label class="form-label col-xs-3">年龄要求：</label>
				<div class="formControls  col-sm-2 "  style="display:inline-block" >
					<select  class="select" size="1" name="Age_requirements">
	  					<option value="20-25岁">20-25岁 </option>
	  					<option value="25-30岁">25-30岁</option>
	  					<option value="30-35岁 ">30-35岁 </option>
	  					<option value="35-40岁 " selected = "selected" >35-40岁 </option>
	  					<option value="40-45岁">40-45岁</option>
	  					<option value="45-50岁"> 45-50岁</option>
	  					<option value="50岁以上">50岁以上</option>
					</select>
					
				</div>
			</div>
			<div class="row cl">
				<label class="form-label col-xs-3">性别要求：</label>
					<div class="formControls col-xs-8 col-sm-9 skin-minimal">
						<div class="radio-box">
							<label for="gender-1">男</label>
							<input type="radio" id="gender-1" name="gender" value="男" checked>
						</div>
						<div class="radio-box">
							<label for="gender-2">女</label>
							<input type="radio" id="gender-2" value="女" name="gender">
						</div>
						<div class="radio-box">
							<label for="gender-3">保密</label>
							<input type="radio" id="gender-3" value="保密" name="gender">
						</div>
					</div>
				</div>
				<div class="row cl">
				<label class="form-label col-xs-3">工作职责：</label>
				<div class="formControls col-xs-2 ">
					<textarea name="work_duty" rows="5" cols="100" placeholder="请输入工作职责"></textarea>
				</div>
				</div>	
				<div class="row cl">
				<label class="form-label col-xs-3">任职资格：</label>
				<div class="formControls col-xs-2 ">
					<textarea name="qualifications" rows="5" cols="100" placeholder="请输入任职资格"></textarea>
				</div>
				</div>
			<div class="row cl">
				<label class="form-label col-xs-3">B D归属：</label>
				<div class="formControls col-xs-2" style="display:inline-block" >
					<select  class="select" size="1" name="ascription" id="ascription" >
	  					<option value="1" selected="selected">请选择用户 </option>
					</select>
				</div>
				<label class="form-label col-xs-3">负责顾问：</label>
				<div class="formControls col-xs-2"  style="display:inline-block" >
					<select  class="select" size="1" name="adviser" id="adviser" >
	  					<option value="请选择二级分类 " selected="selected">请选择用户 </option>
					</select>	
				</div>
			</div>
			<div class="row cl">
				
				<label class="form-label col-xs-3">参与人员：</label>
				<div class="formControls  col-sm-2 "  style="display:inline-block" >
					<select  class="select" size="1" name="participant" id="participant">
	  					<option value="20-25岁">请选择用户 </option>
	  				</select>
	  			</div>	
	  		</div>-->
		<div class="row cl">
			<button class="btn btn-success radius" type="submit" id="add-contacts" value="" style="margin-left:200px">&nbsp;&nbsp;新建职位&nbsp;&nbsp;</button>
		</div>
	</form>
</article>
<script type="text/javascript" src="{% static 'jquery/1.9.1/jquery.min.js' %}"></script>
<script type="text/javascript" src="{% static 'jquery/1.9.1/jquery.js' %}"></script>
<script type="text/javascript" src="{% static 'jquery-ui/1.9.1/jquery-ui.min.js' %}"></script>

<script type="text/javascript" src="{% static 'layer/2.4/layer.js' %}"></script>
<script type="text/javascript" src="{% static 'jquery.validation/1.14.0/jquery.validate.js' %}"></script>
<script type="text/javascript" src="{% static 'jquery.validation/1.14.0/validate-methods.js' %}"></script>
<script type="text/javascript" src="{% static 'jquery.validation/1.14.0/messages_zh.js' %}"></script>
<script type="text/javascript" src="{% static 'h-ui/js/H-ui.min.js' %}"></script>
<script type="text/javascript" src="{% static 'My97DatePicker/4.8/WdatePicker.js' %}"></script>
<script type="text/javascript" src="{% static 'webuploader/0.1.5/webuploader.min.js' %}"></script>
<script type="text/javascript" src="{% static 'ueditor/1.4.3/ueditor.config.js' %}"></script>
<script type="text/javascript" src="{% static 'ueditor/1.4.3/ueditor.all.min.js' %}"></script>
<script type="text/javascript" src="{% static 'ueditor/1.4.3/lang/zh-cn/zh-cn.js' %}"></script>
<script type="text/javascript" src="{% static 'h-ui.admin/js/H-ui.admin.js' %}"></script>
<script language="javascript">
$(document).ready(function(){
	var test_num=0
	$.ajax({
		async: false,
		url:"contacts-ajax",
		type:'GET',
		dataType: 'json',
		data:{'test_num':test_num},
		success:function(ret){
			var company_list=[];
			var contacts_list=[];
			
			$.each(ret, function(i,item){
				if(company_list.indexOf(item.company_name)==-1){
					company_list.push(item.company_name)
				}
				if(contacts_list.indexOf(item.contact_name)==-1){
					contacts_list.push(item.contact_name)
				}
				
			$(function(){
				$( "#company_name" ).autocomplete({
				      source: company_list,
				      messages:{
				          noResults:function(){
				        	 // layer.msg('没有与该关键字匹配的公司！',{icon:2,time:1000}  
				        	 // );
				          },
				          results:function(){  
				          }}
				    });
			});
			//联系人seclct
			  $("#company_name").change(function(){
				  var company_flags= $(" #company_name ").val()
				  var contact_name=$("#contact_name")
				  contact_name.empty().append('<option value="'+"请选择联系人"+'">'+"请选择联系人"+ '</option>')
				  $.each(ret, function(i,item){
					  if (item.company_name==company_flags){
						  alert(company_flags);
						  option_str = '<option value="'+item.contact_name+'">'+item.contact_name+ '</option>'
						  contact_name.append(option_str)
					  }
				  });
					
			});
				  
				
	});
	}
  });

	$(function(){
		//这些往下是新的方法

		var ajax_option={
				success:function(ret){
				
					if(ret == 'success'){
		        		var index = parent.layer.getFrameIndex(window.name);
		        		
		        		// 刷新父页面
		        		parent.location.reload();
		    			parent.layer.close(index);
		        	}else{
		        		alert("添加失败");
		        	}
				}
		};
				//这之上是新添的代码 
		$("#ask-form").validate({
			rules:{
				
			},
			onkeyup:false,
			focusCleanup:true,
			success:"valid",
			submitHandler:function(form){
				//var remark_data = $('#remark_data').val();
				//var remark_info = $('#remark_info').val();
				//从这开始这是这个函数新的代码
				$(form).ajaxSubmit(ajax_option);
				//$(form).ajaxSubmit();
				//$(window.parent.document).find("#data_string").val(remark_data);
				//$(window.parent.document).find("#comment").val(remark_info);
				//var index = parent.layer.getFrameIndex(window.name);
				//parent.layer.close(index);
				//parent.location.reload();
			}
		});
	});
});


</script>